<?xml version="1.0" encoding="UTF-8"?>
<Module>
	<ModulePrefs title="Tabla desde docs"
	description="Tabla cargada con paginacion y parametrizada."
	author_affiliation="Capgemini">
	<Require feature="idi"/>
	<Require feature="locked-domain" />
</ModulePrefs>
  
	<UserPref name="_table_query_url" default_value="" display_name="Data source url" required="true" />
	
	<UserPref name="_NumElemPorPagina" default_value="" display_name="Número de elementos por página:" required="true" />
	<UserPref name="_Col" default_value="" display_name="Escoger primeras n columnas:" />	
	<UserPref name="VarListaColumnas" default_value="" display_name="Lista de columnas a mostrar (números de columna separados por comas):" />
	
<Content type="html"><![CDATA[

<script src="http://www.google.com/jsapi" type="text/javascript"></script>

<style type="text/css">
	 .filaPar {
		background: white; 
		border-bottom: 1px solid #E2E2E2; 
		height: 45px; 
		font-family:  Arial, Helvetica, sans-serif;
		font-size:14px;
	}
	.filaImpar {
		background: #DFE3E5; 
		border-bottom: 1px solid #E2E2E2; 
		height: 45px; 
		font-family: Arial, Helvetica, sans-serif;
		font-size:14px;
	}
	.filaSeleccionada{
		background: white; 
		border-bottom: 1px solid #A22E212; 
		height: 45px; 
		font-family: Arial, Helvetica, sans-serif;
		font-size:14px;
	}
	.filaHover{
		background: #F0EEE2; 
		border-bottom: 1px solid #B2B2B2; 
		height: 45px;
		font-family: Arial, Helvetica, sans-serif;
		font-size:14px;
	}
	#tablediv table,
	#tablediv table tr,
	#tablediv table	tr td {
		font-family: Arial, Helvetica, sans-serif !important;
	}		
	.formateoCelda {
		font-family: Arial, Helvetica, sans-serif !important;
		padding-left: 5px !important;
	}
	.header {
		background: #1e5799; /* Old browsers */		
		color: white; 
		font-size:15px; 
		font-weight: bold;
		text-align: center;
		font-family: Arial, Helvetica, sans-serif;
		height: 35px;
	}
	a.enlaceTabla,
	a:active.enlaceTabla,
	a:visited.enlaceTabla {
		color: #3F78B2;
	}
	a:hover.enlaceTabla {
		color: #009EE5;
	}
	img.loading {
		margin: 5% 0 0 40%;
	}
</style>

<div id="tablediv"><img class="loading" width="100" src="https://gsites-labs-capgemini-valencia.googlecode.com/svn/trunk/img/loading.gif"/></div>

	<h2>
		
		<table border="0" bordercolor="#888" cellspacing="0" style="color:rgb(11,83,148);font-family:trebuchet ms,sans-serif;font-weight:normal;font-size:large;border-collapse:collapse;border-top-color:rgb(255,255,255);border-right-color:rgb(255,255,255);border-bottom-color:rgb(255,255,255);border-left-color:rgb(255,255,255);border-top-width:0px;border-right-width:0px;border-bottom-width:0px;border-left-width:0px">
			<tbody>
			<tr>
				<td style="width:3px;height:28px"><br></td>
				<td style="width:602px;height:28px"><span style="border-collapse:separate"><span style="line-height:18px"><span style="font-size:x-large">Ficha Cliente Airbus</span></span></span></td>
				<td style="width:321px;height:28px">
				<div style="text-align:right"><a href="https://sites.google.com/a/bbva.com/portal-gcs/listaclientespruebas" imageanchor="1"><img border="0" src="https://sites.google.com/a/bbva.com/portal-gcs/boton_volver.png"></a></div>
				<div></div>
				</td>
			</tr>
			</tbody>
		</table>
		
		<hr>
		
	</h2>

	
	<table border="0" bordercolor="#888" cellspacing="0" style="border-collapse:collapse;border-top-color:rgb(136,136,136);border-right-color:rgb(136,136,136);border-bottom-color:rgb(136,136,136);border-left-color:rgb(136,136,136);border-top-width:0px;border-right-width:0px;border-bottom-width:0px;border-left-width:0px">
		<tbody>
		<tr>
			<td style="width:222px;height:180px">&nbsp;<img border="0" height="159" src="https://sites.google.com/a/bbva.com/portal-gcs/listaclientespruebas/ficha-cliglobal001/logo%20airbus.png?height=159&amp;width=200" width="200">
				<div style="display:block;text-align:left"><br></div>
				<div style="display:block;text-align:left"></div>
			</td>
			<td style="width:511px;height:180px">&nbsp;<br>
				<ul>
					<li><font color="#0b5394" style="font-family:trebuchet ms,sans-serif;font-size:small">Código Cliente:</font><span style="font-family:trebuchet ms,sans-serif;font-size:small">&nbsp;VWAGBEBB004</span></li>
					<li><font color="#0b5394" style="font-family:trebuchet ms,sans-serif;font-size:small">Producto o servicio:</font><span style="font-family:trebuchet ms,sans-serif;font-size:small">&nbsp;Host to Host</span></li>
					<li><font color="#0b5394" style="font-family:trebuchet ms,sans-serif;font-size:small">Detalle:</font><span style="font-family:trebuchet ms,sans-serif;font-size:small">&nbsp;</span><span style="font-family:trebuchet ms,sans-serif;font-size:small;line-height:17px;text-align:justify">Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.&nbsp;</span></li>
					<li><font color="#0b5394" style="font-family:trebuchet ms,sans-serif;font-size:small">Países:</font><span style="font-family:trebuchet ms,sans-serif;font-size:small">&nbsp;Francia, Gran Bretaña, Hong Kong, Italia, Alemania, Bélgica, España, Holanda, México, Chile, Perú, Venezuela.</span></li>
				</ul>
			</td>			
		</tr>
		</tbody>
	</table>


<script type="text/javascript"> 
    
	var gadgetHelper = null;
	
	var varListaColumnas = "";
	var	_Col = ""; 
	
	var prefs = new _IG_Prefs(); // User preferences
	//var _filaDescartadas = prefs.getInt("_filaDescartadas");
	var	_Col = prefs.getInt("_Col");
	var urlTable = prefs.getString("_table_query_url");
	var	numElePag = prefs.getInt("_NumElemPorPagina");
	var varListaColumnas = prefs.getString("VarListaColumnas");
	
	_IG_RegisterOnloadHandler(loadVisualizationAPI);
	
	function loadVisualizationAPI() 
	{
		google.load("visualization", "1", {"packages": ["table"]});
		google.setOnLoadCallback(sendQuery);
	}

	function sendQuery() 
	{
		gadgetHelper = new google.visualization.GadgetHelper();
		//var query = gadgetHelper.createQueryFromPrefs(prefs);
	  
		var opts = {dataType:'jsonp'};
		
		var query = new google.visualization.Query(urlTable, opts);
		
		//query.setQuery("select A,B ");
		query.setQuery("select * ");
		query.send(handleQueryResponse);
		
		/*		
		var values = SpreadsheetApp.getActiveSheet().getRange(2, 3, 6, 4).getValues();
		Browser.msgBox(values[0][0]);	

		var data = new google.visualization.DataTable();
		getValue(rowIndex, columnIndex);
		*/
		
	}

	function myClickHandler()
	{
		var selection = myVis.getSelection();

		for (var i = 0; i < selection.length; i++) {
			var item = selection[i];
			if (item.row != null && item.column != null) {
			  message += '{row:' + item.row + ',column:' + item.column + '}';
			} else if (item.row != null) {
			  message += '{row:' + item.row + '}';
			} else if (item.column != null) {
			  message += '{column:' + item.column + '}';
			}
		  }
		  if (message == '') {
			message = 'nothing';
		  }
		  alert('You selected ' + message);
	}
	
	
	
	function handleQueryResponse(response) 
	{
		console.debug('handleQueryResponse <-- ');
		if (!gadgetHelper.validateResponse(response)) { return; }
	
		data = response.getDataTable();
		
		
		var valoresColumna = data.getValue(1,1);
		
		console.debug('version 1');
		
		
		console.debug('data.getValue(1,1) <-- '+data.getValue(1,1));
		
		
		document.getElementById('tablediv').innerHTML = valoresColumna;
		//document.getElementById('tablediv').innerHTML = 'Fred Flinstone';
		
	}
	
	
	
	

	
	

</script>
]]>
</Content>
</Module>