<?xml version="1.0" encoding="UTF-8"?>
<Module>
<ModulePrefs title="Sample Spreadsheet Gadget"
             description="Fun sample spreadsheet Gadget."
             author="Google Engineering"
             author_affiliation="Google Inc."
             author_email="visualization.api+spreadsheet@gmail.com"
             screenshot="/ig/modules/spreadsheet.png"
             thumbnail="/ig/modules/spreadsheet-thm.png" >
<Require feature="idi"/>
<Require feature="locked-domain" />
</ModulePrefs>
  
<UserPref name="_table_query_url" display_name="Data source url" required="true"/>
  <UserPref name="_filaDescartadas" default_value="0" display_name="Descartar primeras n filas:" required="true"/>
  <UserPref name="_Col" default_value="4" display_name="Escoger primeras n columnas:" required="true"/>
  
<UserPref name="_table_query_refresh_interval"
          display_name="Data refresh interval (minutes)"
          default_value="0" datatype="enum" required="false">
<EnumValue value="0" display_value="Do not refresh"/>
<EnumValue value="60" display_value="1"/>
<EnumValue value="300" display_value="5"/>
<EnumValue value="1800" display_value="30"/>
</UserPref>
<Content type="html"><![CDATA[

<script src="http://www.google.com/jsapi" type="text/javascript"></script>

<div id="tablediv" style="overflow: auto;">
<img src="http://www.google.com/ig/images/spinner.gif"/>
</div>

<style type="text/css">
   
   .tablaGeneral{
      border-collapse:collapse;
   }

   .tablaGeneral td{
      padding-left: 5px;
   }

   .cabecera{
       background: blue;
       color: white;
       font-size:18px;
       font-family:Arial;
   }

   .filaDestacada{
      background: #F3F3F3;
      border-bottom:solid #E2E2E2;
   }

   .filaNormal{
       background: white;
       border-bottom:solid #E2E2E2;
   }

</style>

<script>

var gadgetHelper = null;
var _filaDescartadas = 0;
var _Col = 3;
_IG_RegisterOnloadHandler(loadVisualizationAPI);

function loadVisualizationAPI() {
  google.load("visualization", "1");
  google.setOnLoadCallback(sendQuery);
}

function sendQuery() {
  var prefs = new _IG_Prefs(); // User preferences
  _filaDescartadas = prefs.getInt("_filaDescartadas");
  _Col = prefs.getInt("_Col");
  gadgetHelper = new google.visualization.GadgetHelper();
  var query = gadgetHelper.createQueryFromPrefs(prefs);
  query.send(handleQueryResponse);
}

function handleQueryResponse(response) {

  if (!gadgetHelper.validateResponse(response)) { return; }

  var data = response.getDataTable();
  var html = [];   // start the HTML output string

  html.push('<table class="tablaGeneral">');
  html.push('<tr class="cabecera">');
  for (var col = 0; col < Math.min(data.getNumberOfColumns(),_Col); col++) {
    //var formattedValue = data.getFormattedValue(0, col);
    var formattedValue = data.getFormattedValue(_filaDescartadas, col);
    html.push('<td>');
       formattedValue = escapeHtml(formattedValue);
       html.push(formattedValue);
    html.push('</td>');
  }
  html.push('</tr>');
  for (var row = _filaDescartadas + 1; row < data.getNumberOfRows(); row++) {
    if((row % 2) == 0)
       html.push('<tr class="filaDestacada">');
    else
       html.push('<tr class="filaNormal">');
      
    for (var col = 0; col < Math.min(data.getNumberOfColumns(),_Col); col++) {

      var formattedValue = data.getFormattedValue(row, col);
      formattedValue = escapeHtml(formattedValue);

        //html.push('<span style="color:red; font-size:24pt; font-weight:bold;">');
        html.push('<td>');
           html.push(formattedValue);
        html.push('</td>');
    }
    html.push('</tr>');
  }
  html.push('</table>');

  var tableDiv = _gel('tablediv');
  tableDiv.innerHTML = html.join('');
  tableDiv.style.width = document.body.clientWidth + 'px';
  tableDiv.style.height = document.body.clientHeight + 'px';
}

function escapeHtml(text) {
  if (text == null) {
    return '';
  }
  return _hesc(text);
}

</script>
]]>
</Content>
</Module>?